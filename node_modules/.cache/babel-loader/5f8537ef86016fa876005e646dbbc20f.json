{"ast":null,"code":"var _jsxFileName = \"/Users/johnloberger/Flatiron/code/mod5/frontend/src/components/Dashboard.js\";\nimport React from 'react';\nimport { connect } from 'react-redux'; // import { fetchUsersSuccess } from '../actions/user'\n\nimport { fetchStatSuccess } from '../actions/stat';\nimport { fetchCitiesSuccess } from '../actions/city';\nimport { currentUser } from '../actions/auth';\nimport ClimateMap from './ClimateMap';\nimport climScores from './climScores.json';\n\nclass Dashboard extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      climateScores: climScores\n    };\n  }\n\n  componentDidMount() {\n    const token = localStorage.getItem('token');\n    console.log(token);\n\n    if (!token) {\n      this.props.history.push('/login');\n    } else {\n      const reqObj = {\n        method: 'GET',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      };\n      fetch('http://localhost:3001/current_user', reqObj).then(resp => resp.json()).then(data => {\n        this.props.currentUser(data);\n      });\n      fetch('http://localhost:3001//locations').then(resp => resp.json()).then(locations => {\n        const usersLocations = locations.filter(loc => loc.user_id === this.props.auth.id);\n        console.log(usersLocations);\n        this.props.fetchLocationsSuccess(usersLocations);\n      }); // fetch('http://localhost:3001/users')\n      // .then(resp => resp.json())\n      // .then(data => {\n      //   this.props.fetchUsersSuccess(data)\n      // })\n\n      fetch('https://api.waqi.info/map/bounds/?latlng=85,-180,-85.05115,180&token=87b2bba6a5b2e26c577ffc48e297eaed82a8408c').then(resp => resp.json()).then(stations => {\n        let x = stations.data.slice(0, 1000);\n        this.props.fetchStatSuccess(stations.data);\n      });\n      fetch('https://public.opendatasoft.com/api/records/1.0/search/?dataset=1000-largest-us-cities-by-population-with-geographic-coordinates&q=&rows=1000&sort=-rank&facet=city&facet=state').then(resp => resp.json()).then(cities => {\n        this.props.fetchCitiesSuccess(cities.records);\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(ClimateMap, {\n      stations: this.props.stats,\n      cities: this.props.cities,\n      climateScores: this.state.climateScores,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    auth: state.auth,\n    // users: state.users,\n    stats: state.stats,\n    cities: state.cities\n  };\n};\n\nconst mapDispatchToProps = {\n  // fetchUsersSuccess,\n  fetchStatSuccess,\n  fetchCitiesSuccess,\n  currentUser\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Dashboard);","map":{"version":3,"sources":["/Users/johnloberger/Flatiron/code/mod5/frontend/src/components/Dashboard.js"],"names":["React","connect","fetchStatSuccess","fetchCitiesSuccess","currentUser","ClimateMap","climScores","Dashboard","Component","state","climateScores","componentDidMount","token","localStorage","getItem","console","log","props","history","push","reqObj","method","headers","fetch","then","resp","json","data","locations","usersLocations","filter","loc","user_id","auth","id","fetchLocationsSuccess","stations","x","slice","cities","records","render","stats","mapStateToProps","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux'\n// import { fetchUsersSuccess } from '../actions/user'\nimport { fetchStatSuccess } from '../actions/stat'\nimport { fetchCitiesSuccess } from '../actions/city'\nimport { currentUser } from '../actions/auth'\nimport ClimateMap from './ClimateMap'\nimport climScores from './climScores.json'\n\nclass Dashboard extends React.Component {\n\n  state = {\n    climateScores: climScores,\n  }\n  \n  componentDidMount(){\n    const token = localStorage.getItem('token')\n    console.log(token)\n    if (!token) {\n      this.props.history.push('/login')\n    } else {\n      const reqObj = {\n        method: 'GET',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      }\n      fetch('http://localhost:3001/current_user', reqObj)\n      .then(resp => resp.json())\n      .then(data => {\n        this.props.currentUser(data)\n      })\n      fetch('http://localhost:3001//locations')\n      .then(resp => resp.json())\n      .then(locations => {\n        const usersLocations = locations.filter(loc => loc.user_id === this.props.auth.id)\n        console.log(usersLocations)\n        this.props.fetchLocationsSuccess(usersLocations)\n      })\n      // fetch('http://localhost:3001/users')\n      // .then(resp => resp.json())\n      // .then(data => {\n      //   this.props.fetchUsersSuccess(data)\n      // })\n      fetch('https://api.waqi.info/map/bounds/?latlng=85,-180,-85.05115,180&token=87b2bba6a5b2e26c577ffc48e297eaed82a8408c')\n      .then(resp => resp.json())\n      .then(stations => {\n        let x = stations.data.slice(0,1000)\n        this.props.fetchStatSuccess(stations.data)\n      })\n      fetch('https://public.opendatasoft.com/api/records/1.0/search/?dataset=1000-largest-us-cities-by-population-with-geographic-coordinates&q=&rows=1000&sort=-rank&facet=city&facet=state')\n      .then(resp => resp.json())\n      .then(cities => {\n        this.props.fetchCitiesSuccess(cities.records)\n      })\n    }\n  }\n\n\n  \n  render(){ \n    return (\n      <div>\n       \n        <ClimateMap stations={this.props.stats} cities={this.props.cities} climateScores={this.state.climateScores}/>\n      </div>)\n  };\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    auth: state.auth,\n    // users: state.users,\n    stats: state.stats,\n    cities: state.cities,\n  }\n}\n\nconst mapDispatchToProps = {\n  // fetchUsersSuccess,\n  fetchStatSuccess,\n  fetchCitiesSuccess,\n  currentUser\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Dashboard);\n\n\n"]},"metadata":{},"sourceType":"module"}