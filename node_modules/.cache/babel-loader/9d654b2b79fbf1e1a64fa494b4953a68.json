{"ast":null,"code":"var _jsxFileName = \"/Users/johnloberger/Flatiron/code/mod5/frontend/src/components/Dashboard.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { fetchUsersSuccess } from '../actions/user';\nimport { fetchStatSuccess } from '../actions/stat';\nimport { fetchCitiesSuccess } from '../actions/city';\nimport ClimateMap from './ClimateMap';\n\nclass Dashboard extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      climateScores: []\n    };\n\n    this.getClimateScores = () => {\n      state.cities.map(cityObj => {\n        fetch(`https://climate-score.p.rapidapi.com/${cityObj.fields.coordinates[0]}/${cityObj.fields.coordinates[1]}`, {\n          \"method\": \"GET\",\n          \"headers\": {\n            \"x-rapidapi-host\": \"climate-score.p.rapidapi.com\",\n            \"x-rapidapi-key\": \"c5855f8358mshe884588b34ae70ep1a1627jsn5e1e97c23a80\"\n          }\n        }).then(resp => resp.json()).then(data => {\n          this.setState({\n            climateScores: [...this.state.climateScores, data]\n          });\n          console.log('finished! ');\n        });\n      });\n    };\n  }\n\n  componentDidMount() {\n    fetch('https://public.opendatasoft.com/api/records/1.0/search/?dataset=1000-largest-us-cities-by-population-with-geographic-coordinates&q=&rows=1000&sort=-rank&facet=city&facet=state').then(resp => resp.json()).then(cities => {\n      console.log(cities.records);\n      this.props.fetchCitiesSuccess(cities.records);\n    });\n    this.getClimateScores();\n    this.interval = setInterval(() => {\n      this.getClimateScores();\n    }, 5000); // fetch('http://localhost:3001/users')\n    // .then(resp => resp.json())\n    // .then(data => {\n    //   this.props.fetchUsersSuccess(data)\n    // })\n    // fetch('https://api.waqi.info/map/bounds/?latlng=85,-180,-85.05115,180&token=87b2bba6a5b2e26c577ffc48e297eaed82a8408c')\n    // .then(resp => resp.json())\n    // .then(stations => {\n    //   this.props.fetchStatSuccess(stations.data)\n    // })\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.interval);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(ClimateMap, {\n      stations: this.props.stats,\n      cities: this.props.cities,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    users: state.users,\n    stats: state.stats,\n    cities: state.cities\n  };\n};\n\nconst mapDispatchToProps = {\n  fetchUsersSuccess,\n  fetchStatSuccess,\n  fetchCitiesSuccess\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Dashboard);","map":{"version":3,"sources":["/Users/johnloberger/Flatiron/code/mod5/frontend/src/components/Dashboard.js"],"names":["React","connect","fetchUsersSuccess","fetchStatSuccess","fetchCitiesSuccess","ClimateMap","Dashboard","Component","state","climateScores","getClimateScores","cities","map","cityObj","fetch","fields","coordinates","then","resp","json","data","setState","console","log","componentDidMount","records","props","interval","setInterval","componentWillUnmount","clearInterval","render","stats","mapStateToProps","users","mapDispatchToProps"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,iBAAT,QAAkC,iBAAlC;AACA,SAASC,gBAAT,QAAiC,iBAAjC;AACA,SAASC,kBAAT,QAAmC,iBAAnC;AACA,OAAOC,UAAP,MAAuB,cAAvB;;AAGA,MAAMC,SAAN,SAAwBN,KAAK,CAACO,SAA9B,CAAwC;AAAA;AAAA;AAAA,SAEtCC,KAFsC,GAE9B;AACNC,MAAAA,aAAa,EAAE;AADT,KAF8B;;AAAA,SAkCpCC,gBAlCoC,GAkCjB,MAAM;AACvBF,MAAAA,KAAK,CAACG,MAAN,CAAaC,GAAb,CAAkBC,OAAD,IAAa;AAC5BC,QAAAA,KAAK,CAAE,wCAAuCD,OAAO,CAACE,MAAR,CAAeC,WAAf,CAA2B,CAA3B,CAA8B,IAAGH,OAAO,CAACE,MAAR,CAAeC,WAAf,CAA2B,CAA3B,CAA8B,EAAxG,EAA2G;AAC9G,oBAAU,KADoG;AAE9G,qBAAW;AACT,+BAAmB,8BADV;AAET,8BAAkB;AAFT;AAFmG,SAA3G,CAAL,CAOCC,IAPD,CAOMC,IAAI,IAAIA,IAAI,CAACC,IAAL,EAPd,EAQCF,IARD,CAQMG,IAAI,IAAI;AACZ,eAAKC,QAAL,CAAc;AACZZ,YAAAA,aAAa,EAAE,CACb,GAAG,KAAKD,KAAL,CAAWC,aADD,EAEbW,IAFa;AADH,WAAd;AAMAE,UAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACD,SAhBD;AAiBD,OAlBD;AAmBD,KAtDmC;AAAA;;AAMtCC,EAAAA,iBAAiB,GAAE;AACjBV,IAAAA,KAAK,CAAC,iLAAD,CAAL,CACCG,IADD,CACMC,IAAI,IAAIA,IAAI,CAACC,IAAL,EADd,EAECF,IAFD,CAEMN,MAAM,IAAI;AACdW,MAAAA,OAAO,CAACC,GAAR,CAAYZ,MAAM,CAACc,OAAnB;AACA,WAAKC,KAAL,CAAWtB,kBAAX,CAA8BO,MAAM,CAACc,OAArC;AACD,KALD;AAMA,SAAKf,gBAAL;AACA,SAAKiB,QAAL,GAAgBC,WAAW,CAAC,MAAM;AAChC,WAAKlB,gBAAL;AACD,KAF0B,EAExB,IAFwB,CAA3B,CARiB,CAWjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEC;;AAEDmB,EAAAA,oBAAoB,GAAG;AACrBC,IAAAA,aAAa,CAAC,KAAKH,QAAN,CAAb;AACD;;AAyBDI,EAAAA,MAAM,GAAE;AACN,wBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACA,oBAAC,UAAD;AAAY,MAAA,QAAQ,EAAE,KAAKL,KAAL,CAAWM,KAAjC;AAAwC,MAAA,MAAM,EAAE,KAAKN,KAAL,CAAWf,MAA3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADA,CADF;AAIH;;AA9DqC;;AAiExC,MAAMsB,eAAe,GAAIzB,KAAD,IAAW;AACjC,SAAO;AACL0B,IAAAA,KAAK,EAAE1B,KAAK,CAAC0B,KADR;AAELF,IAAAA,KAAK,EAAExB,KAAK,CAACwB,KAFR;AAGLrB,IAAAA,MAAM,EAAEH,KAAK,CAACG;AAHT,GAAP;AAKD,CAND;;AAQA,MAAMwB,kBAAkB,GAAG;AACzBjC,EAAAA,iBADyB;AAEzBC,EAAAA,gBAFyB;AAGzBC,EAAAA;AAHyB,CAA3B;AAMA,eAAeH,OAAO,CAACgC,eAAD,EAAkBE,kBAAlB,CAAP,CAA6C7B,SAA7C,CAAf","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux'\nimport { fetchUsersSuccess } from '../actions/user'\nimport { fetchStatSuccess } from '../actions/stat'\nimport { fetchCitiesSuccess } from '../actions/city'\nimport ClimateMap from './ClimateMap'\n\n\nclass Dashboard extends React.Component {\n\n  state = {\n    climateScores: []\n  }\n\n  componentDidMount(){\n    fetch('https://public.opendatasoft.com/api/records/1.0/search/?dataset=1000-largest-us-cities-by-population-with-geographic-coordinates&q=&rows=1000&sort=-rank&facet=city&facet=state')\n    .then(resp => resp.json())\n    .then(cities => {\n      console.log(cities.records)\n      this.props.fetchCitiesSuccess(cities.records)\n    })\n    this.getClimateScores();\n    this.interval = setInterval(() => {\n      this.getClimateScores();\n    }, 5000);\n    // fetch('http://localhost:3001/users')\n    // .then(resp => resp.json())\n    // .then(data => {\n    //   this.props.fetchUsersSuccess(data)\n    // })\n    // fetch('https://api.waqi.info/map/bounds/?latlng=85,-180,-85.05115,180&token=87b2bba6a5b2e26c577ffc48e297eaed82a8408c')\n    // .then(resp => resp.json())\n    // .then(stations => {\n    //   this.props.fetchStatSuccess(stations.data)\n    // })\n      \n    }\n\n    componentWillUnmount() {\n      clearInterval(this.interval);\n    }\n\n    getClimateScores = () => {\n      state.cities.map((cityObj) => {\n        fetch(`https://climate-score.p.rapidapi.com/${cityObj.fields.coordinates[0]}/${cityObj.fields.coordinates[1]}`, {\n          \"method\": \"GET\",\n          \"headers\": {\n            \"x-rapidapi-host\": \"climate-score.p.rapidapi.com\",\n            \"x-rapidapi-key\": \"c5855f8358mshe884588b34ae70ep1a1627jsn5e1e97c23a80\"\n            }\n          })\n        .then(resp => resp.json())\n        .then(data => {\n          this.setState({\n            climateScores: [\n              ...this.state.climateScores,\n              data\n            ]\n          })\n          console.log('finished! ')\n        })\n      })\n    }\n    \n    \n    render(){ \n      return (\n        <div>\n        <ClimateMap stations={this.props.stats} cities={this.props.cities}/>\n      </div>)\n  };\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    users: state.users,\n    stats: state.stats,\n    cities: state.cities\n  }\n}\n\nconst mapDispatchToProps = {\n  fetchUsersSuccess,\n  fetchStatSuccess,\n  fetchCitiesSuccess\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Dashboard);\n\n\n"]},"metadata":{},"sourceType":"module"}